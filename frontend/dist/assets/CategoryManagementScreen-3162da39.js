import{P as u,r as o,aS as Z,aT as $,aU as ee,aV as te,j as e,B as a,l as i,Q as d,aW as se,A as ae,e as re}from"./index-51727cb1.js";import{T as ne}from"./Table-718aaeb2.js";import{M as r}from"./Modal-664f545f.js";const E=({categories:j,setCategoriesData:l})=>{const[h,C]=o.useState(""),[p,c]=o.useState(!1),[x,w]=o.useState(null),[m,S]=o.useState(null),[_,y]=o.useState(!1),[v,A]=o.useState(""),[L,b]=o.useState(""),[f,T]=o.useState(""),[G,U]=o.useState(!1),[D,N]=o.useState(""),[B,I]=o.useState(""),H=s=>{C(s.target.value)},q=j?j.filter(s=>s.name.toLowerCase().includes(h.toLowerCase())||s.description.toLowerCase().includes(h.toLowerCase())):[],[O]=Z(),[P,{isLoading:M}]=$(),[Q,{isLoading:R}]=ee(),[W,{isLoading:k}]=te(),V=()=>{N(""),I(""),U(!0)},F=()=>{U(!1)},z=async()=>{var s;try{const n=await O({name:D,description:B});n.data.result?(d.success("Category Added Successfully."),l(g=>[...g,n.data.result]),U(!1)):d.error(n.error.data.message)}catch(t){d.error(((s=t==null?void 0:t.data)==null?void 0:s.message)||(t==null?void 0:t.error))}},J=async()=>{var s;try{await Q({categoryId:x}),d.success("Category Blocked Successfully."),w(null),c(!1),l(t=>t.map(n=>n._id===x?{...n,isListed:!1}:n))}catch(t){d.error(((s=t==null?void 0:t.data)==null?void 0:s.message)||(t==null?void 0:t.error))}},K=async()=>{var s;try{await W({categoryId:m}),d.success("Category Un Blocked Successfully."),S(null),c(!1),l(t=>t.map(n=>n._id===m?{...n,isListed:!0}:n))}catch(t){d.error(((s=t==null?void 0:t.data)==null?void 0:s.message)||(t==null?void 0:t.error))}},X=s=>{A(s._id),b(s.name),T(s.description),y(!0)},Y=async()=>{var s;try{const t=await P({categoryId:v,name:L,description:f});t.data?(d.success("Category Updated Successfully."),l(n=>n.map(g=>g._id===v?{...g,name:L,description:f}:g)),y(!1)):d.error(t.error.data.message),A(null),y(!1)}catch(t){d.error(((s=t==null?void 0:t.data)==null?void 0:s.message)||(t==null?void 0:t.error))}};return e.jsxs(e.Fragment,{children:[e.jsx(a,{children:e.jsxs(a.Group,{className:"mt-3",controlId:"exampleForm.ControlInput1",children:[e.jsx(a.Label,{children:"Search categories:"}),e.jsx(a.Control,{style:{width:"500px"},value:h,type:"text",placeholder:"Enter Name or Description........",onChange:H})]})}),e.jsx(i,{type:"button",variant:"primary",className:"mt-3 mb-3",onClick:()=>V(),children:"Add Category"}),e.jsxs(ne,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"SI No."}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Update"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Manage"})]})}),e.jsx("tbody",{children:q.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.description}),e.jsx("td",{children:e.jsx(i,{type:"button",variant:"primary",onClick:()=>X(s),children:"Update"})}),e.jsx("td",{children:s.isListed===!0?e.jsx("span",{className:"text-success",style:{fontWeight:"bold"},children:"Listed"}):e.jsx("span",{className:"text-danger",style:{fontWeight:"bold"},children:"Unlisted"})}),e.jsx("td",{children:s.isListed===!0?e.jsx(i,{type:"button",variant:"danger",onClick:()=>{w(s._id),c(!0)},children:"UnList"}):e.jsx(i,{type:"button",variant:"success",onClick:()=>{S(s._id),c(!0)},children:"ReList"})})]},t))})]}),e.jsxs(r,{show:p,onHide:()=>c(!1),children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Confirmation"})}),e.jsx(r.Body,{children:x?e.jsxs(e.Fragment,{children:["Are you sure you want to Un List this category?",e.jsx(i,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(i,{variant:"danger",onClick:J,disabled:R,children:R?"UnListing...":"UnList"})]}):m?e.jsxs(e.Fragment,{children:["Are you sure you want to re list this category?",e.jsx(i,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(i,{variant:"success",onClick:K,disabled:k,children:k?"ReListing...":"ReList"})]}):null})]}),e.jsxs(r,{show:_,onHide:()=>y(!1),children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Update Category"})}),e.jsx(r.Body,{children:e.jsxs(a,{children:[e.jsxs(a.Group,{controlId:"name",children:[e.jsx(a.Label,{children:"Name"}),e.jsx(a.Control,{type:"text",value:L,name:"name",onChange:s=>b(s.target.value)})]}),e.jsxs(a.Group,{controlId:"Description",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{type:"text",value:f,onChange:s=>T(s.target.value)})]})]})}),e.jsxs(r.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:()=>y(!1),children:"Cancel"}),e.jsx(i,{variant:"primary",onClick:Y,disabled:M,children:M?"Updating...":"Update"})]})]}),e.jsxs(r,{show:G,onHide:F,children:[e.jsx(r.Header,{closeButton:!0,children:e.jsx(r.Title,{children:"Add New Category"})}),e.jsx(r.Body,{children:e.jsxs(a,{children:[e.jsxs(a.Group,{controlId:"newCategoryName",children:[e.jsx(a.Label,{children:"Name"}),e.jsx(a.Control,{type:"text",value:D,name:"name",onChange:s=>N(s.target.value),placeholder:"Enter Category name"})]}),e.jsxs(a.Group,{controlId:"newCategoryDescription",children:[e.jsx(a.Label,{children:"Description"}),e.jsx(a.Control,{type:"text",value:B,name:"description",onChange:s=>I(s.target.value),placeholder:"Enter Description"})]})]})}),e.jsxs(r.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:F,children:"Cancel"}),e.jsx(i,{variant:"primary",onClick:z,children:"Add"})]})]})]})};E.propTypes={categories:u.arrayOf(u.shape({_id:u.string.isRequired,name:u.string.isRequired,description:u.string.isRequired,isListed:u.bool.isRequired})).isRequired};const ce=()=>{const[j,l]=o.useState([]),[h,{isLoading:C}]=se();return o.useEffect(()=>{try{(async()=>{const x=(await h()).data.categoryData;l(x)})()}catch(p){d.error(p),console.error("Error fetching categories:",p)}},[h]),e.jsx("div",{children:e.jsxs(ae,{children:[e.jsx("h1",{className:"p-2",children:"Categories List"}),C?e.jsx(re,{}):e.jsx(E,{categories:j,setCategoriesData:l})]})})};export{ce as default};
