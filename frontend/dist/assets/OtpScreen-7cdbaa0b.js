import{r as n,u as b,a as C,d as E,m as R,n as B,j as s,B as c,e as I,l as g,s as N,Q as o}from"./index-908e2f29.js";import{F as k}from"./FormContainer-5dba1fb9.js";import"./Row-cc9ed775.js";const H=()=>{const[u,p]=n.useState(""),[l,i]=n.useState(!1),[y,f]=n.useState(!1),[r,m]=n.useState(60),d=b(),j=C(),{userInfo:h}=E(t=>t.userAuth),[v,{isLoading:w}]=R(),[T,{isLoading:P}]=B();n.useEffect(()=>{h&&d("/")},[d,h]),n.useEffect(()=>{let t;return r>0&&(t=setInterval(()=>{m(a=>a-1)},1e3)),()=>clearInterval(t)},[r]),n.useEffect(()=>{r===0&&f(!0)},[r]);const L=async t=>{var a,x,O;t.preventDefault(),i(!0);try{const e=await v({otp:u}).unwrap();j(N({...e})),d("/")}catch(e){p(""),(a=e==null?void 0:e.data)!=null&&a.message?o.error((x=e==null?void 0:e.data)==null?void 0:x.message):o.error(((O=e==null?void 0:e.data)==null?void 0:O.message)||e.error)}finally{i(!1)}},S=async()=>{var t;try{i(!0),o.info("Resending OTP..."),await T().unwrap(),o.success("New OTP sent successfully!"),f(!1),m(60)}catch(a){o.error(((t=a==null?void 0:a.data)==null?void 0:t.message)||a.error)}finally{i(!1)}};return s.jsxs(k,{children:[s.jsx("h1",{children:"OTP verification"}),r>0?s.jsxs("p",{children:["OTP will expire in ",r," seconds"]}):s.jsxs("p",{children:["Time to enter OTP has expired. Click ",s.jsx("b",{children:"Resend OTP"})," to get a new one."]}),s.jsxs(c,{onSubmit:L,children:[s.jsxs(c.Group,{className:"my-2",controlId:"otp",children:[s.jsx(c.Label,{children:"Enter OTP"}),s.jsx(c.Control,{type:"text",placeholder:"Enter OTP",value:u,onChange:t=>p(t.target.value)})]}),(l||w||P)&&s.jsx(I,{}),s.jsx(g,{type:"submit",variant:"primary",className:"mt-3",disabled:l,children:"Verify OTP"}),y&&s.jsx(g,{variant:"link",className:"mt-3",onClick:S,disabled:l,children:"Resend OTP"})]})]})};export{H as default};
